<div class="feedback-modal">
  <div class="modal-header">
    <h2 mat-dialog-title>Provide Feedback</h2>
    <button mat-icon-button (click)="close()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <mat-dialog-content>
    <div class="service-info">
      <p class="subtitle">
        <span class="service-name">{{ data.booking.serviceName }}</span> service was completed by 
        <span class="expert-name">{{ data.booking.expertName }}</span>
      </p>
    </div>

    <div class="rating-section">
      <h3>How was your experience?</h3>
      <div class="stars">
        <button
          *ngFor="let star of stars"
          mat-icon-button
          class="star-button"
          (click)="setRating(star)"
          (mouseenter)="setHoveredRating(star)"
          (mouseleave)="clearHoveredRating()"
          [class.filled]="star <= (hoveredRating || rating)">
          <mat-icon [class.gold]="star <= (hoveredRating || rating)">
            {{ getStarIcon(star) }}
          </mat-icon>
        </button>
      </div>
      <p class="rating-text" *ngIf="rating > 0">
        {{ rating }} star{{ rating > 1 ? 's' : '' }}
      </p>
    </div>

    <div class="comment-section">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Share your experience</mat-label>
        <textarea
          matInput
          [(ngModel)]="comment"
          placeholder="Tell us about your experience..."
          rows="4"
          maxlength="500">
        </textarea>
        <mat-hint align="end">{{ comment.length }}/500</mat-hint>
      </mat-form-field>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="close()" [disabled]="isSubmitting">
      Skip for Now
    </button>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="submitFeedback()"
      [disabled]="!canSubmit() || isSubmitting">
      <span *ngIf="!isSubmitting">Submit Feedback</span>
      <span *ngIf="isSubmitting">Submitting...</span>
    </button>
  </mat-dialog-actions>
</div>
